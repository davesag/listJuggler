<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">

  <title>listJuggler Example Use</title>
  <!-- Load local jQuery. This can be overridden with a ?jquery=___ param. -->
  <script src="../libs/jquery-loader.js"></script>
  
  <!-- boostrap is not essential but makes it nicer -->
  <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
  <script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

  <!-- In your actual code you'd use the scripts in the dist/ folder. -->
  <script src="../build/dataMatcher.js"></script>
  <script src="../build/listJuggler.js"></script>
</head>
<body>
  <div class="container">
    <div class="jumbotron">
      <h2>listJuggler <small>Juggles lists good!</small></h2>
      <p>When the lists are in an iFrame but the script is in the parent page.</p>
      <a class="btn btn-primary" href="example.html">See regular Example</a>
      <a class="btn btn-primary" href="iFrameExample.html">See other iFrame Example</a>
    </div>
  <div class="container">
    <h2>And in an iFrame</h2>
    <div class="well center-block">
      <iframe src="iFrameContentsScriptless.html" width="100%"></iframe>
    </div>
  </div>
  <script>
    $(document).ready(function(){
      var myFrame = $("iframe"),
          myDocument = $(myFrame.get(0).contentDocument),
          myElements, timedOut = false, timeoutTimer;
      myDocument.ready(function(){
        timeoutTimer = setTimeout(function(){
          console.error("Search for elements timed out.");
          timedOut = true;
        }, 9999);
        function findElements() {
          if (!timedOut) {
            myElements = myDocument.find("ul, ol");
            console.debug("Looking for elements", myElements);
            if (myElements.length === 0) {
              setTimeout(function(){
                findElements();
              }, 500);
            } else {
              $(document).trigger("found-elements");
            }
          }
        }
        $(document).on("found-elements", function(evt){
          clearTimeout(timeoutTimer);
          console.debug("success - iFrame", myFrame, "document", myDocument, "elements", myElements);
          myElements.listJuggler({
            document: myFrame.get(0).contentDocument,
            window: myFrame.get(0).contentWindow
          });
        });
        findElements();
      });
    });
  </script>
</body>
</html>
